---

title: Peak matching functionalities


keywords: fastai
sidebar: home_sidebar



nb_path: "nbdev_nbs/mass_spec/match.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbdev_nbs/mass_spec/match.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_centroid_mz" class="doc_header"><code>match_centroid_mz</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/mass_spec/match.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_centroid_mz</code>(<strong><code>spec_mzs</code></strong>:<code>ndarray</code>, <strong><code>query_mzs</code></strong>:<code>ndarray</code>, <strong><code>spec_mz_tols</code></strong>:<code>ndarray</code>)</p>
</blockquote>
<p>Matching query masses against sorted MS2/spec centroid masses,
only closest (minimal mass error) peaks are matched.</p>
<p>Args:
    spec_mzs (np.ndarray): MS2 or spec mz values, 1-D float array
    query_mzs (np.ndarray): query mz values, n-D float array
    spec_mz_tols (np.ndarray): Da tolerance array, same shape as spec_mzs</p>
<p>Returns:
    np.ndarray: np.ndarray of int32, the shape is the same as query_mzs.
      -1 means no peaks are matched for the query mz</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_profile_mz" class="doc_header"><code>match_profile_mz</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/mass_spec/match.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_profile_mz</code>(<strong><code>spec_mzs</code></strong>:<code>ndarray</code>, <strong><code>query_mzs</code></strong>:<code>ndarray</code>, <strong><code>spec_mz_tols</code></strong>:<code>ndarray</code>, <strong><code>spec_intens</code></strong>:<code>ndarray</code>)</p>
</blockquote>
<p>Matching query masses against sorted MS2/spec profile masses,
only highest peaks are matched.</p>
<p>Args:
    spec_mzs (np.ndarray): MS2 or spec mz values, 1-D float array
    query_mzs (np.ndarray): query mz values, n-D float array
    spec_mz_tols (np.ndarray): Da tolerance array, same shape as spec_mzs</p>
<p>Returns:
    np.ndarray: np.ndarray of int32, the shape is the same as query_mzs.
      -1 means no peaks are matched for the query mz</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_one_raw_with_numba" class="doc_header"><code>match_one_raw_with_numba</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/mass_spec/match.py#L100" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_one_raw_with_numba</code>(<strong><code>spec_idxes</code></strong>, <strong><code>frag_start_idxes</code></strong>, <strong><code>frag_end_idxes</code></strong>, <strong><code>all_frag_mzs</code></strong>, <strong><code>all_spec_mzs</code></strong>, <strong><code>all_spec_intensities</code></strong>, <strong><code>peak_start_idxes</code></strong>, <strong><code>peak_end_idxes</code></strong>, <strong><code>matched_intensities</code></strong>, <strong><code>matched_mz_errs</code></strong>, <strong><code>ppm</code></strong>, <strong><code>tol</code></strong>)</p>
</blockquote>
<p>Internel function to match fragment mz values to spectrum mz values.
Matched_mz_errs[i] = np.inf if no peaks are matched.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PepSpecMatch" class="doc_header"><code>class</code> <code>PepSpecMatch</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/mass_spec/match.py#L154" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PepSpecMatch</code>(<strong><code>charged_frag_types</code></strong>=<em><code>['b_z1', 'b_z2', 'y_z1', 'y_z2', 'b_modloss_z1', 'b_modloss_z2', 'y_modloss_z1', 'y_modloss_z2']</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

