---

title: Utils


keywords: fastai
sidebar: home_sidebar



nb_path: "nbdev_nbs/utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbdev_nbs/utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2022-07-13 18:02:44&gt; NumExpr defaulting to 8 threads.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_bar" class="doc_header"><code>process_bar</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_bar</code>(<strong><code>iterator</code></strong>, <strong><code>len_iter</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_logger" class="doc_header"><code>set_logger</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_logger</code>(<strong><code>log_file_name</code></strong>=<em><code>''</code></em>, <strong><code>stream</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>log_level</code></strong>:<code>str</code>=<em><code>'info'</code></em>, <strong><code>overwrite</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Set the log stream and file.
All previously set handlers will be disabled with this command.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>log_file_name : str, None
    The file name to where the log is written.
    Folders are automatically created if needed.
    This is relative to the current path. When an empty string is provided,
    a log is written to the AlphaTims "logs" folder with the name
    "log_yymmddhhmmss" (reversed timestamp year to seconds).
    If None, no log file is saved.
    Default is "".
stream : bool
    If False, no log data is sent to stream.
    If True, all logging can be tracked with stdout stream.
    Default is True.
log_level : str | int
    The logging level. Usable values are defined in Python's "logging"
    module. Could be: 'debug', 'info', 'warning', 'error', 'critical'.
    See <a href="/peptdeep/utils.html#log_level_dict"><code>log_level_dict</code></a>.
    Default is 'info'.
overwrite : bool
    If True, overwrite the log_file if one exists.
    If False, append to this log file.
    Default is False.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>: str
    The file name to where the log is written.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_platform_info" class="doc_header"><code>show_platform_info</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_platform_info</code>()</p>
</blockquote>
<p>Log all platform information.
This is done in the following format:</p>

<pre><code>- [timestamp]&gt; Platform information:
- [timestamp]&gt; system         - [...]
- [timestamp]&gt; release        - [...]
- [timestamp]&gt; version        - [...]
- [timestamp]&gt; machine        - [...]
- [timestamp]&gt; processor      - [...]
- [timestamp]&gt; cpu count      - [...]
- [timestamp]&gt; cpu frequency  - [...]
- [timestamp]&gt; ram            - [...]/[...] Gb (available/total)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_python_info" class="doc_header"><code>show_python_info</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L162" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_python_info</code>()</p>
</blockquote>
<p>Log all Python information.
This is done in the following format:</p>

<pre><code>- [timestamp]&gt; Python information:
- [timestamp]&gt; alphatims          - [current_version]
- [timestamp]&gt; [required package] - [current_version]
- ...
- [timestamp]&gt; [required package] - [current_version]</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_ms_file_names_to_dict" class="doc_header"><code>parse_ms_file_names_to_dict</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_ms_file_names_to_dict</code>(<strong><code>ms_file_list</code></strong>:<code>list</code>)</p>
</blockquote>
<p>Load spectrum file paths into a dict:
    "/Users/xxx/raw_name.raw" -&gt; {"raw_name":"/Users/xxx/raw_name.raw"}</p>
<p>Args:
    spectrum_file_list (list): File path list</p>
<p>Returns:
    dict: {"raw_name":"/Users/xxx/raw_name.raw", ...}</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="explode_multiple_columns" class="doc_header"><code>explode_multiple_columns</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L235" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>explode_multiple_columns</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>columns</code></strong>:<code>list</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="regional_sampling" class="doc_header"><code>regional_sampling</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L251" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>regional_sampling</code>(<strong><code>psm_df</code></strong>:<code>DataFrame</code>, <strong><code>target</code></strong>:<code>str</code>=<em><code>'rt_norm'</code></em>, <strong><code>n_train</code></strong>:<code>int</code>=<em><code>1000</code></em>, <strong><code>return_test_df</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>random_state</code></strong>=<em><code>1337</code></em>)</p>
</blockquote>
<p>Divide <code>psm_df</code> into 10 bins and sample training values
from each bins for model fine-tuning. The values are defined in the <code>target</code>
column (<code>rt_norm</code> or <code>ccs</code>).</p>
<p>Args:
    psm_df (pd.DataFrame): Dataframe of PSMs.
    target (str, optional): Target columns to sample.
        Defaults to 'rt_norm'.
    n_train (int, optional): The number of training PSMs
        to sample. Defaults to 1000.
    return_test_df (bool, optional): If also return <code>test_df</code>.
        <code>test_df</code> contains the PSMs that are not sampled.
        Defaults to False.
    random_state: <code>random_state</code> in <code>df.sample()</code>.</p>
<p>Returns:
    pd.DataFrame: The sampled training PSMs (dataframe)
    [pd.DataFrame]: The not sampled PSMs (dataframe) for testing.
        Returned only if <code>return_test_df==True</code> in the arguments.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plotting-functions">Plotting functions<a class="anchor-link" href="#Plotting-functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_linear_regression" class="doc_header"><code>evaluate_linear_regression</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L314" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_linear_regression</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>x</code></strong>=<em><code>'rt_pred'</code></em>, <strong><code>y</code></strong>=<em><code>'rt_norm'</code></em>, <strong><code>ci</code></strong>=<em><code>95</code></em>, <strong><code>n_sample</code></strong>=<em><code>10000000</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_linear_regression_plot" class="doc_header"><code>evaluate_linear_regression_plot</code><a href="https://github.com/MannLabs/peptdeep/tree/main/peptdeep/utils.py#L339" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_linear_regression_plot</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>x</code></strong>=<em><code>'rt_pred'</code></em>, <strong><code>y</code></strong>=<em><code>'rt_norm'</code></em>, <strong><code>ci</code></strong>=<em><code>95</code></em>, <strong><code>n_sample</code></strong>=<em><code>100000</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

