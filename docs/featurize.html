---

title: Functionalities for featurization/tensorization


keywords: fastai
sidebar: home_sidebar



nb_path: "nbdev_nbs/model/featurize.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbdev_nbs/model/featurize.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_all_mod_features" class="doc_header"><code>get_all_mod_features</code><a href="https://github.com/MannLabs/alphapeptdeep/tree/main/peptdeep/model/featurize.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_all_mod_features</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">MOD_TO_FEATURE</span><span class="p">[</span><span class="s1">&#39;Phospho@S&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0., 1., 0., 3., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0.])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_mod_feature" class="doc_header"><code>parse_mod_feature</code><a href="https://github.com/MannLabs/alphapeptdeep/tree/main/peptdeep/model/featurize.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_mod_feature</code>(<strong><code>nAA</code></strong>:<code>int</code>, <strong><code>mod_names</code></strong>:<code>List</code>[<code>str</code>], <strong><code>mod_sites</code></strong>:<code>List</code>[<code>int</code>])</p>
</blockquote>
<p>Get modification feature of a given peptide (len=nAA).
Note that <code>site=0</code> is for peptide N-term modification,
<code>site=1</code> is for peptide C-term modification, and
<code>1&lt;=site&lt;=nAA</code> is for residue modifications on the peptide.
Args:
    nAA (int): the lenght of the peptide sequence
    mod_names (List[str]): the modification names
    mod_sites (List[str]): the modification sites corresponding
        to <code>mod_names</code> on the peptide
Returns:
    np.array: 2-D feature array with shape <code>(nAA+2,mod_feature_size)</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_batch_mod_feature" class="doc_header"><code>get_batch_mod_feature</code><a href="https://github.com/MannLabs/alphapeptdeep/tree/main/peptdeep/model/featurize.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_batch_mod_feature</code>(<strong><code>batch_df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>Args:
    batch_df (pd.DataFrame): dataframe with 'sequence', 'mods', 'mod_sites' and 'nAA' columns.
        All sequence lengths must be the same, meaning that nAA values must be equal.
Returns:
    np.array: 3-D tensor with shape (batch_size, nAA+2, mod_feature_size)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_batch_aa_indices" class="doc_header"><code>get_batch_aa_indices</code><a href="https://github.com/MannLabs/alphapeptdeep/tree/main/peptdeep/model/featurize.py#L100" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_batch_aa_indices</code>(<strong><code>seq_array</code></strong>:<code>Union</code>[<code>List</code>[<code>T</code>], <code>ndarray</code>])</p>
</blockquote>
<p>Convert peptide sequences into AA ID array. ID=0 is reserved for masking,
so ID of 'A' is 1, ID of 'B' is 2, ..., ID of 'Z' is 26 (maximum).
Zeros are padded into the N- and C-term for each sequence.</p>
<p>Args:
    seq_array (Union[List,np.ndarray]):
        list or 1-D array of sequences with the same length
Returns:
    np.array: 2-D <code>np.int32</code> array with the shape
    <code>(len(seq_array), len(seq_array[0])+2)</code>. Zeros is padded into the
    N- and C-term of each sequence, so the 1st-D is <code>len(seq_array[0])+2</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_ascii_indices" class="doc_header"><code>get_ascii_indices</code><a href="https://github.com/MannLabs/alphapeptdeep/tree/main/peptdeep/model/featurize.py#L122" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_ascii_indices</code>(<strong><code>seq_array</code></strong>:<code>Union</code>[<code>List</code>[<code>T</code>], <code>ndarray</code>])</p>
</blockquote>
<p>Convert peptide sequences into ASCII code array.
The values are from 0 to 127.
Zeros are padded into the N- and C-term for each sequence.</p>
<p>Args:
    seq_array (Union[List,np.ndarray]):
        list or 1-D array of sequences.
Returns:
    np.array: 2-D <code>np.int32</code> array with the shape
    <code>(len(seq_array), max seq length+2)</code>.
    For the the sequence whose length is shorter than max seq length,
    zeros are padded to the missing values.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_instrument_indices" class="doc_header"><code>parse_instrument_indices</code><a href="https://github.com/MannLabs/alphapeptdeep/tree/main/peptdeep/model/featurize.py#L155" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_instrument_indices</code>(<strong><code>instrument_list</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

